<link rel="stylesheet" href="https://unpkg.com/ngx-bootstrap/datepicker/bs-datepicker.css">




<nav class="navbar sticky-top navbar-light bg-light navbar-expand-lg">
    <ul class="navbar-nav">
        <li class="nav-item active">
            <a class="nav-link">Gastos locales</a>
        </li>
        <li class="nav-item">
            <a
                class="nav-link"
                routerLink="/tarifario"
                routerLinkActive="router-link-active"
            >
                Principal
            </a>
        </li>
    </ul>
</nav>




<div class="container-fluid mt-5">
    <tabset
        [justified]="true"
        type="pills"
    >
        <tab heading="GASTOS DE ORIGEN">
            <div class="row mt-3">
                <div class="col-md-6 ">
                    <span class="font-weight-bold">ORIGEN</span>
                    <div class="input-group input-group-sm">
                        <ng-template #templatePort let-model="item" let-index="index">
                            <img [src]="model.icon" class="mr-1" style="width: 16px"/>
                            <span>{{model.text}}</span>
                          </ng-template>
                      <input id="search-origin" type="text" class="form-control" placeholder="Escriba aquí..."
                        [(ngModel)]="objectGasto.origen.text"
                        [typeaheadAsync]="true"
                        [typeahead]="searchPorts"
                        [typeaheadItemTemplate]="templatePort"
                        [typeaheadOptionsLimit]="10"
                        [typeaheadWaitMs]="300"
                        typeaheadOptionField="text"
                        (keyup)="setTextSearch($event)"
                        (typeaheadOnSelect)="onSelectPortOrigin($event)"/>
                 <i class="fa fa-fw fa-spinner fa-spin float-right input-loading hide"></i>
                    </div>
                </div>


            </div>
        </tab>
        <tab heading="GASTOS DE DESTINO">
            <div class="row mt-3">
                <div class="col-md-6">
                    <span class="font-weight-bold">
                      DESTINO</span>
                    <div class="input-group input-group-sm">
                        <input id="search-destination" type="text" class="form-control" placeholder="Escriba aquí..."
                        [(ngModel)]="objectGasto.destino.text"
                        [typeaheadAsync]="true"
                        [typeahead]="searchPorts"
                        [typeaheadItemTemplate]="templatePort"
                        [typeaheadOptionsLimit]="10"
                        [typeaheadWaitMs]="300"
                        typeaheadOptionField="text"
                        (keyup)="setTextSearch($event)"
                        (typeaheadOnSelect)="onSelectPortDestination($event)"/>
                 <i class="fa fa-fw fa-spinner fa-spin float-right input-loading hide"></i>
                    </div>
                </div>


            </div>
        </tab>
    </tabset>







    <div>
        <div class="py-3">
            <div class="container-fluid">
                <!-- TABLA -->
                <table class="table table-sm table-bordered  rounded mt-5">
                    <thead class="text-dark bg-gray">
                        <tr>
                            <th>PROVEEDOR / AGENTE</th>
                            <th>VIA</th>
                            <th [hidden]="myDropDown !=='2'">TIPO VIA</th>
                            <th>MONEDA</th>
                            <th>TARIFA</th>
                            <th>FACTOR</th>

                            <th>FECHA</th>
                            <th></th>
                        </tr>
                    </thead>



                    <!-- reg es el valor del objeto / regs es el [] -->
                    <tbody>
                        <tr *ngFor="let gasto of gastos; let i = index">
                            <!-- proveedor/AGENTE -->
                            <td>
                              <div class="input-group input-group-sm">
                                <input
                                id="search-agente"

                                placeholder="Escriba aquí..."
                                type="text"
                                [(ngModel)]="objectGasto.proveedor.name"
                                [typeahead]="searchClients"
                                [typeaheadOptionsLimit]="10"
                                typeaheadOptionField="name"
                                (keyup)="setTextSearch($event)"
                                (typeaheadOnSelect)="onSelectClient($event)"
                                [typeaheadScrollable]="true"
                                [typeaheadOptionsInScrollableView]="5"
                                class=" form-control  input-group input-group-sm"
                                >
                                </div>
                            </td>



                            <!-- vias -->


                            <td>
                                <div class="input-group input-group-sm">
                                    <select
                                        [(ngModel)]="myDropDown"
                                        class="form-control form-control-sm"
                                    >
                                        <option
                                            *ngFor="let via of vias"
                                            value="{{via.code}}"
                                        >
                                            {{via.description}}
                                        </option>
                                    </select>
                                </div>
                            </td>


                            <!-- tipo VIA MARITIMA -->
                            <td [hidden]="myDropDown !=='2'">
                                <div class="input-group input-group-sm">
                                    <select class="selectpicker  form-control">
                                        <option value>-</option>
                                        <option value="0">FCL</option>
                                        <option value="1">LCL</option>
                                    </select>
                                </div>
                            </td>




                            <!-- MONEDA -->




                            <td>
                                <div class="input-group input-group-sm">
                                    <select
                                        class="form-control form-control-sm"
                                        [(ngModel)]="gastos.currencies"
                                    >
                                        <option
                                            *ngFor="let item of currencies"
                                            value="{{item.code}}"
                                        >
                                            {{item.description}}
                                        </option>
                                    </select>
                                </div>
                            </td>




                            <!-- TARIFA -->


                            <td>
                                <div class="input-group input-group-sm  d-flex justify-content-center">
                                    <button
                                        type="button"
                                        class=" btn btn-primary btn-sm"
                                        data-toggle="modal"
                                        data-target="#tarifaxfconceptoModal"
                                        (click)="showtarifaxconceptoModal()"
                                    >
                                        <i class="fa fa-money"></i>
                                    </button>
                                </div>
                            </td>




                            <!-- factor -->


                            <td>
                                <div class="input-group input-group-sm">
                                    <select
                                        class="form-control form-control-sm"
                                        [(ngModel)]="gastos.factors"
                                    >
                                        <option
                                            *ngFor="let factor of factors"
                                            value="{{factor.code}}"
                                        >
                                            {{factor.description}}
                                        </option>
                                    </select>
                                </div>
                            </td>










                            <!-- fecha -->
                            <td>
                                <div class="input-group input-group-sm">
                                    <input
                                        type="text"
                                        class="form-control"
                                        [minDate]="minDate"
                                        bsDatepicker
                                        [bsConfig]="{
                    dateInputFormat: 'DD-MM-YYYY',
                    containerClass: 'theme-red'
                  }"
                                        (keydown.enter)="newRow()"
                                        placement="left"
                                    >
                                </div>
                            </td>




                            <!-- boton nuevo registro -->
                            <td *ngIf="i > 0">
                                <div class="col-auto">
                                    <button
                                        type="submit"
                                        class="btn btn-danger btn-sm"
                                        (click)="deleteRow(i)"
                                    >
                                        X
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>






<!-- Modal -->
<div
    class="modal fade"
    [class.show]="show"
    id="observacionModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
>
    <div
        class="modal-dialog modal-lg"
        role="document"
    >
        <div class="modal-content">
            <div class="modal-header">
                <h5
                    class="modal-title"
                    id="exampleModalLabel"
                >
                    Observaciones
                </h5>
                <button
                    type="button"
                    class="close "
                    data-dismiss="modal"
                    aria-label="Close"
                >
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <div class="input-group">
                        <textarea
                            type="text"
                            class="form-control"
                            name="deploymentName"
                            id="deploymentName"
                            autofocus
                            autocomplete="off"
                        ></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button
                    type="button"
                    class="btn btn-secondary"
                    data-dismiss="modal"
                >
                    Close
                </button>
                <button
                    type="button"
                    class="btn btn-primary"
                >
                    Save changes
                </button>
            </div>
        </div>
    </div>
</div>





<!-- Modal -->
<div
    class="modal fade"
    [class.show]="showtarifaxconcepto"
    id="tarifaxfconceptoModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
>
    <div
        class="modal-dialog modal-lg"
        role="document"
    >
        <div class="modal-content">
            <div class="modal-header">
                <h5
                    class="modal-title"
                    id="exampleModalLabel"
                >
                    TARIFA
                </h5>
                <button
                    type="button"
                    class="close "
                    data-dismiss="modal"
                    aria-label="Close"
                >
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">


                    <table class="table table-sm table-bordered  rounded">
                        <thead class="text-dark bg-gray">
                            <tr>
                                <th>CONCEPTOS</th>
                                <th>VALOR</th>
                                <th>OBSERVACION</th>
                            </tr>
                        </thead>
                        <!-- CONCEPTOS -->
                        <tbody>
                            <tr>
                                <!-- conceptos -->

                                <td>
                                    <div class="input-group input-group-sm">
                                        <input
                                        name="concept" type="text" class="form-control form-control-sm" placeholder="Escriba aquí..."
                                        [(ngModel)]="objectGasto.concepto.description"
                                        (typeaheadOnSelect)="onSelectConcept($event)"
                                        [typeahead]="searchConcepts"
                                        typeaheadOptionField="description"
                                        (keyup)="setTextSearch($event)"
                                        [typeaheadOptionsLimit]="10"
                                        [typeaheadWaitMs]="100"
                                        [typeaheadScrollable]="true"
                                        [typeaheadOptionsInScrollableView]="5"
                                        >
                                        <i class="fa fa-fw fa-spinner fa-spin float-right input-loading hide"></i>
                                    </div>
                                </td>

                                <!-- valor -->
                                <td>
                                    <div class="input-group input-group-sm">


                                        <input
                                            type="text"
                                            class="form-control"
                                            (input)="carData = deleteInputStream($event)"
                                        >
                                    </div>
                                </td>

                                    <!-- observaciuones -->


                                    <td>
                                        <div class="input-group input-group-sm">
                                            <input
                                                type="text"
                                                class="form-control"
                                            >
                                        </div>
                                    </td>


                            </tr>
                        </tbody>
                    </table>


                </div>
            </div>
            <div class="modal-footer">
                <button
                    type="button"
                    class="btn btn-secondary"
                    data-dismiss="modal"
                >
                    Close
                </button>
                <button
                    type="button"
                    class="btn btn-primary"
                >
                    Save changes
                </button>
            </div>
        </div>
    </div>
</div>
